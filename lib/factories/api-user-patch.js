// Generated by CoffeeScript 1.9.3
module.exports.apiUserPatch = function(urlApiUsers, PATCH) {
  return PATCH(urlApiUsers(':id'), function(canUpdateUsers, endForbidden, userUpdateValidator, endUnprocessableJSON, updateUserWhereId, omitPassword) {
    if (!(canUpdateUsers() || canUpdateUsers(params.id))) {
      return endForbidden();
    }
    return userUpdateValidator(body, params.id).then(function(errors) {
      if (errors != null) {
        return endUnprocessableJSON(errors);
      }
      return updateUserWhereId(body, params.id).then(function(updated) {
        return endJSON(omitPassword(updated));
      });
    });
  });
};
